# ğŸ§ª ì‚¬ìš©ì ì¸ì¦ í”Œë¡œìš° ì™„ì „ í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ

## ğŸ¯ ëª©í‘œ: íšŒì›ê°€ì…ë¶€í„° ë¡œê·¸ì¸ê¹Œì§€ ì „ ê³¼ì • ê²€ì¦

## ğŸ“‹ í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

### âœ… ì‚¬ì „ ì¤€ë¹„
- [ ] Database Trigger ì„¤ì • ì™„ë£Œ (`DATABASE_SETUP_GUIDE.md` ì‹¤í–‰)
- [ ] RLS ë³´ì•ˆ ì •ì±… í™œì„±í™” ì™„ë£Œ
- [ ] ì›¹ì‚¬ì´íŠ¸ ì •ìƒ ì ‘ì† í™•ì¸

### ğŸ”¥ í•µì‹¬ í…ŒìŠ¤íŠ¸ í”Œë¡œìš°

## 1ë‹¨ê³„: íšŒì›ê°€ì… í…ŒìŠ¤íŠ¸

### A. ë¸Œë¼ìš°ì € ì„¤ì •
```bash
1. ë¸Œë¼ìš°ì €ì—ì„œ F12 í‚¤ ëˆ„ë¥´ê¸°
2. Console íƒ­ ì„ íƒí•˜ê³  ì—´ì–´ë‘ê¸° (ì¤‘ìš”!)
3. Network íƒ­ë„ í•¨ê»˜ ì—´ì–´ë‘ê¸°
```

### B. íšŒì›ê°€ì… ì§„í–‰
```bash
1. /auth/signup í˜ì´ì§€ ì ‘ì†
2. í…ŒìŠ¤íŠ¸ ì •ë³´ ì…ë ¥:
   - ì´ë©”ì¼: test-$(í˜„ì¬ì‹œê°„)@example.com
   - ë¹„ë°€ë²ˆí˜¸: TestPassword123!
   - ì´ë¦„: í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì
   - ì‚¬ìš©ì íƒ€ì…: íŠ¸ë ˆì´ë„ˆ ë˜ëŠ” ì„¼í„° ìš´ì˜ì ì„ íƒ
3. ì´ìš©ì•½ê´€ ë™ì˜ ì²´í¬
4. íšŒì›ê°€ì… ë²„íŠ¼ í´ë¦­
```

### C. ê²°ê³¼ í™•ì¸
**ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ í™•ì¸í•  ê²ƒ:**
```javascript
// ì˜ˆìƒ ë©”ì‹œì§€ë“¤:
"Starting signup process"
"Calling signUp with user data" 
"Signup result: { user: {...}, session: null }"
"Checking if user profile exists..."
"Creating user profile..." ë˜ëŠ” "Profile already exists"

// ê°€ì¥ ì¤‘ìš”í•œ ë©”ì‹œì§€:
"Confirm your signup: https://[project-id].supabase.co/auth/v1/verify?token=..."
```

**Network íƒ­ì—ì„œ í™•ì¸í•  ê²ƒ:**
- `POST /auth/v1/signup` â†’ 200 ì‘ë‹µ
- `POST /rest/v1/users` â†’ 201 ë˜ëŠ” 409 ì‘ë‹µ (í”„ë¡œí•„ ìƒì„±)

## 2ë‹¨ê³„: ì´ë©”ì¼ ì¸ì¦ í…ŒìŠ¤íŠ¸

### A. ì¸ì¦ ë§í¬ íšë“
```bash
1. ì½˜ì†”ì—ì„œ "Confirm your signup:" ë©”ì‹œì§€ ì°¾ê¸°
2. ë§í¬ ì „ì²´ë¥¼ ë³µì‚¬ (https://...verify?token=... ì „ì²´)
3. ìƒˆ íƒ­ì—ì„œ í•´ë‹¹ ë§í¬ ì—´ê¸°
```

### B. ì¸ì¦ ì™„ë£Œ í™•ì¸
**ì˜ˆìƒ ë™ì‘:**
- ì¸ì¦ ì„±ê³µ ì‹œ: `/auth/welcome` í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰ì…˜
- í™˜ì˜ ë©”ì‹œì§€ì™€ í•¨ê»˜ ì‚¬ìš©ì ì´ë¦„ í‘œì‹œ
- "ê°•ì˜ ë‘˜ëŸ¬ë³´ê¸°" ë²„íŠ¼ í‘œì‹œ

**ì‹¤íŒ¨ ì‹œ:**
- `/auth/error` í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰ì…˜
- êµ¬ì²´ì ì¸ ì˜¤ë¥˜ ë©”ì‹œì§€ í™•ì¸

## 3ë‹¨ê³„: í”„ë¡œí•„ ìƒì„± ê²€ì¦

### A. ë°ì´í„°ë² ì´ìŠ¤ í™•ì¸ (Supabase Dashboard)
```sql
-- 1. auth.users í…Œì´ë¸” í™•ì¸
SELECT id, email, email_confirmed_at, created_at 
FROM auth.users 
WHERE email = 'your-test-email@example.com';

-- 2. public.users í…Œì´ë¸” í™•ì¸  
SELECT id, email, name, role, user_type, created_at
FROM public.users
WHERE email = 'your-test-email@example.com';
```

### B. ì˜ˆìƒ ê²°ê³¼
**auth.users í…Œì´ë¸”:**
- âœ… ë ˆì½”ë“œ ì¡´ì¬
- âœ… `email_confirmed_at` ê°’ì´ ìˆìŒ (ì¸ì¦ ì™„ë£Œ ì‹œ)

**public.users í…Œì´ë¸”:**
- âœ… ë ˆì½”ë“œ ì¡´ì¬ (Database Triggerë¡œ ìë™ ìƒì„±)
- âœ… `role`: 'STUDENT'
- âœ… `user_type`: 'TRAINER' ë˜ëŠ” 'OPERATOR'
- âœ… `name`: ì…ë ¥í•œ ì´ë¦„

## 4ë‹¨ê³„: ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸

### A. ë¡œê·¸ì¸ ì‹œë„
```bash
1. /auth/login í˜ì´ì§€ ì ‘ì†
2. íšŒì›ê°€ì…í•œ ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¡œ ë¡œê·¸ì¸
3. ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ë¡œê·¸ í™•ì¸
```

### B. ì˜ˆìƒ ê²°ê³¼
**ì„±ê³µ ì‹œ:**
- í™ˆí˜ì´ì§€(`/`) ë˜ëŠ” ëŒ€ì‹œë³´ë“œë¡œ ë¦¬ë””ë ‰ì…˜
- í—¤ë”ì— ì‚¬ìš©ì ì •ë³´ í‘œì‹œ
- "ë‚´ ê°•ì˜", "í”„ë¡œí•„" ë“± ì¸ì¦ëœ ì‚¬ìš©ì ë©”ë‰´ í‘œì‹œ

**ì‹¤íŒ¨ ì‹œ:**
- ì½˜ì†”ì—ì„œ ì˜¤ë¥˜ ë©”ì‹œì§€ í™•ì¸
- ë„¤íŠ¸ì›Œí¬ íƒ­ì—ì„œ API ì‘ë‹µ í™•ì¸

## 5ë‹¨ê³„: ì¸ì¦ ìƒíƒœ ê²€ì¦

### A. ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
```javascript
// ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ì‹¤í–‰
const checkAuth = async () => {
  const response = await fetch('/api/auth/user');
  const data = await response.json();
  console.log('Current user:', data);
};
checkAuth();
```

### B. ë³´í˜¸ëœ í˜ì´ì§€ ì ‘ì†
```bash
1. /my/profile í˜ì´ì§€ ì ‘ì† ì‹œë„
2. /my/courses í˜ì´ì§€ ì ‘ì† ì‹œë„
3. /my/orders í˜ì´ì§€ ì ‘ì† ì‹œë„
```

**ì˜ˆìƒ ê²°ê³¼:**
- âœ… ì •ìƒ ì ‘ì† (ë¡œê·¸ì¸ëœ ê²½ìš°)
- âŒ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰ì…˜ (ë¯¸ë¡œê·¸ì¸ ì‹œ)

## ğŸš¨ ë¬¸ì œ í•´ê²° ê°€ì´ë“œ

### ë¬¸ì œ 1: ì½˜ì†”ì— ì¸ì¦ ë§í¬ê°€ ì—†ìŒ
**ì§„ë‹¨:**
```sql
-- Supabase Dashboard â†’ SQL Editorì—ì„œ ì‹¤í–‰
SELECT trigger_name, event_manipulation 
FROM information_schema.triggers 
WHERE trigger_name = 'on_auth_user_created';
```
**í•´ê²°:** `DATABASE_SETUP_GUIDE.md` ë‹¤ì‹œ ì‹¤í–‰

### ë¬¸ì œ 2: ì¸ì¦ ë§í¬ í´ë¦­ ì‹œ 404
**ì›ì¸:** Callback URL ì„¤ì • ì˜¤ë¥˜
**í•´ê²°:** Supabase â†’ Authentication â†’ URL Configuration í™•ì¸

### ë¬¸ì œ 3: í”„ë¡œí•„ì´ ìƒì„±ë˜ì§€ ì•ŠìŒ
**ì§„ë‹¨:**
```sql
-- í”„ë¡œí•„ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
SELECT COUNT(*) FROM public.users WHERE email = 'test-email@example.com';
```
**í•´ê²°:** Database Trigger ì¬ì„¤ì • í•„ìš”

### ë¬¸ì œ 4: ë¡œê·¸ì¸ í›„ 403 ì˜¤ë¥˜
**ì›ì¸:** RLS ì •ì±… ì„¤ì • ì˜¤ë¥˜  
**í•´ê²°:** `SECURITY_FIX_URGENT.sql` ì‹¤í–‰

## ğŸ“Š ì„±ê³µ ê¸°ì¤€

### âœ… ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼ ì‹œ:
- íšŒì›ê°€ì… â†’ í”„ë¡œí•„ ìë™ ìƒì„± âœ…
- ì´ë©”ì¼ ì¸ì¦ â†’ ê³„ì • í™œì„±í™” âœ…  
- ë¡œê·¸ì¸ â†’ ë³´í˜¸ëœ í˜ì´ì§€ ì ‘ê·¼ âœ…
- ì‚¬ìš©ì ì •ë³´ â†’ ì •í™•í•œ í”„ë¡œí•„ í‘œì‹œ âœ…

### ğŸ“ˆ ì„±ëŠ¥ ê¸°ì¤€:
- íšŒì›ê°€ì… ì²˜ë¦¬: < 3ì´ˆ
- ì´ë©”ì¼ ì¸ì¦: ì¦‰ì‹œ
- ë¡œê·¸ì¸ ì²˜ë¦¬: < 2ì´ˆ
- í˜ì´ì§€ ë¡œë”©: < 3ì´ˆ

## ğŸ‰ í…ŒìŠ¤íŠ¸ ì™„ë£Œ í›„

**ëª¨ë“  í…ŒìŠ¤íŠ¸ê°€ ì„±ê³µí•˜ë©´:**
1. âœ… ì‚¬ìš©ì ì¸ì¦ ì‹œìŠ¤í…œ ì™„ì „ êµ¬ì¶•
2. âœ… ì´ë©”ì¼ ì¸ì¦ í”Œë¡œìš° ì •ìƒ ì‘ë™
3. âœ… ìë™ í”„ë¡œí•„ ìƒì„± ì‹œìŠ¤í…œ ì‘ë™
4. âœ… ë³´ì•ˆ ì •ì±… ì •ìƒ ì ìš©

**ì´ì œ í”„ë¡œë•ì…˜ ë°°í¬ ì¤€ë¹„ ì™„ë£Œ!** ğŸš€

## ğŸ“ ì¶”ê°€ ì§€ì›

**í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ì‹œ í•„ìš”í•œ ì •ë³´:**
1. ì–´ëŠ ë‹¨ê³„ì—ì„œ ì‹¤íŒ¨í–ˆëŠ”ì§€
2. ë¸Œë¼ìš°ì € ì½˜ì†” ë©”ì‹œì§€ (ìŠ¤í¬ë¦°ìƒ·)
3. Network íƒ­ì˜ API ì‘ë‹µ (ìŠ¤í¬ë¦°ìƒ·)
4. Supabase ë¡œê·¸ (Dashboard â†’ Logs)

ì´ ì •ë³´ì™€ í•¨ê»˜ ë¬¸ì˜í•˜ì‹œë©´ ì •í™•í•œ í•´ê²°ì±…ì„ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!